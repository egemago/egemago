<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Roberto</title>

  <!-- Open Graph -->
  <meta property="og:type" content="website">
  <meta property="og:title" content="Roberto">
  <meta property="og:description" content="The New Page">
  <meta property="og:url" content="https://egemago.pages.dev">
  <meta property="og:image" content="https://egemago.pages.dev/assets/og-image.png">
  <meta property="og:image:width" content="1200">
  <meta property="og:image:height" content="630">

  <!-- Twitter Card -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="Roberto">
  <meta name="twitter:description" content="The New Page">
  <meta name="twitter:image" content="https://egemago.pages.dev/assets/og-image.png">
  <meta name="twitter:site" content="@egemago">

  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600&display=swap" rel="stylesheet">

  <style>
    :root{
      --overlay: rgba(0,0,0,0.18);
      --card-bg: rgba(16, 16, 24, 0.68);
      --border: rgba(255,255,255,0.12);
      --button: rgba(255,255,255,0.12);
      --button-hover: rgba(255,255,255,0.22);
      --text-dim: rgba(255,255,255,0.72);
      --text-dimmer: rgba(255,255,255,0.58);
      --chip: rgba(255,255,255,0.10);
      --chip-border: rgba(255,255,255,0.14);
    }

    *{ box-sizing:border-box; }
    html, body{ height:100%; }

    body{
      margin:0;
      min-height:100vh;
      font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      color:#f2f2f2;

      /* keep body transparent; paint background via ::before so it covers full page */
      background: transparent;

      display:flex;
      justify-content:center;
      align-items:flex-start;
      padding:48px 16px;
      position: relative;
    }

    body::before{
      content:"";
      position: fixed;
      inset: 0;
      z-index: -1;

      background:
        radial-gradient(circle at center, rgba(11,16,32,0.35) 0%, rgba(0,0,0,0.85) 70%),
        linear-gradient(var(--overlay), var(--overlay)),
        url("assets/bg.png") center 58% / cover no-repeat;

      transform: translateZ(0);
    }

    main{
      width:100%;
      max-width:520px;
      background: var(--card-bg);
      backdrop-filter: blur(14px);
      border-radius: 22px;
      border: 1px solid var(--border);
      padding: 24px;
      box-shadow: 0 10px 40px rgba(0,0,0,0.35);
    }

    /* Header */
    .header{
      display:flex;
      gap:16px;
      align-items:center;
      margin-bottom:14px;
    }

    .pfp{
      width:72px;
      height:72px;
      border-radius:16px;
      object-fit:cover;
      border:1px solid rgba(255,255,255,0.16);
      flex: 0 0 auto;
    }

    .nameRow{
      display:flex;
      align-items:baseline;
      gap:10px;
      flex-wrap:wrap;
    }

    .displayName{
      font-size: 2.15rem;
      font-weight: 600;
      letter-spacing: 0.2px;
      line-height: 1.05;
      margin:0;
    }

    /* Chips */
    .chips{
      display:flex;
      flex-wrap:wrap;
      gap:10px;
      margin: 10px 0 18px;
    }

    .chip{
      padding:8px 12px;
      border-radius:999px;
      background: var(--chip);
      border:1px solid var(--chip-border);
      font-size: 0.95rem;
      color: rgba(255,255,255,0.88);
      letter-spacing: 0.1px;
    }

    /* Section titles */
    .sectionTitle{
      margin: 18px 0 10px;
      font-size: 0.78rem;
      letter-spacing: 0.22em;
      text-transform: uppercase;
      color: rgba(255,255,255,0.55);
    }

    /* Link buttons */
    .links{
      display:flex;
      flex-direction:column;
      gap:12px;
      margin-top: 2px;
    }

    a.button{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;

      padding:14px 14px;
      border-radius:14px;
      text-decoration:none;
      color:#ffffff;

      background: var(--button);
      border:1px solid var(--border);

      transition: background 0.2s ease, transform 0.15s ease;
    }

    a.button:hover{
      background: var(--button-hover);
      transform: translateY(-1px);
    }

    a.button:focus{
      outline: 3px solid rgba(255,255,255,0.40);
      outline-offset: 2px;
    }

    .leftWrap{
      display:flex;
      align-items:center;
      gap:12px;
      min-width: 0;
    }

    /* Social logos */
    .socialLogo{
      width:22px;
      height:22px;
      object-fit:contain;
      flex: 0 0 22px;
      display:block;
    }

    .linkText{
      font-size: 1.02rem;
      font-weight: 600;
      letter-spacing: 0.1px;
      white-space: nowrap;
      overflow:hidden;
      text-overflow: ellipsis;
    }

    .arrow{
      opacity:0.65;
      font-size: 1.1rem;
      margin-left: 8px;
      flex:0 0 auto;
    }

    /* Extended bio */
    .bioBox{
      background: rgba(255,255,255,0.08);
      border:1px solid rgba(255,255,255,0.12);
      border-radius:14px;
      padding:14px;
      color: rgba(255,255,255,0.86);
      line-height: 1.5;
      font-size: 0.98rem;
    }

    /* Media cards (I AM) */
    .mediaGrid{
      display:flex;
      flex-direction:column;
      gap:12px;
    }

    .mediaCard{
      display:flex;
      gap:14px;
      align-items:center;
      padding:14px;
      border-radius:16px;
      background: rgba(255,255,255,0.10);
      border:1px solid rgba(255,255,255,0.12);
    }

    .mediaThumb{
      width:92px;
      height:132px;
      border-radius:14px;
      object-fit: cover;
      object-position: center;
      border:1px solid rgba(255,255,255,0.14);
      flex:0 0 auto;
      display:block;
      background: rgba(0,0,0,0.15);
    }

    .mediaText{ min-width:0; }

    .mediaTitle{
      margin:0;
      font-size: 1.05rem;
      font-weight: 600;
    }

    .mediaSub{
      margin:4px 0 0;
      color: var(--text-dim);
      font-size: 0.98rem;
    }

    /* Favorites grid (Albums + Animanga) */
    .favGrid{
      display:grid;
      grid-template-columns: repeat(2, 1fr);
      gap:12px;
    }

    @media (min-width: 560px){
      .favGrid{
        grid-template-columns: repeat(5, 1fr);
      }
    }

    .favCard{
      display:block;
      text-decoration:none;
      color: inherit;
      border-radius:16px;
      background: rgba(255,255,255,0.10);
      border:1px solid rgba(255,255,255,0.12);
      overflow:hidden;
      transition: transform 0.15s ease, background 0.2s ease;
    }

    .favCard:hover{
      transform: translateY(-1px);
      background: rgba(255,255,255,0.14);
    }

    .favCover{
      width:100%;
      aspect-ratio: 1 / 1;
      object-fit: cover;
      display:block;
      background: rgba(0,0,0,0.15);
    }

    /* Animanga uses poster ratio */
    .posterCover{
      width:100%;
      aspect-ratio: 2 / 3;
      object-fit: cover;
      display:block;
      background: rgba(0,0,0,0.15);
    }

    .favMeta{
      padding:10px 10px 12px;
      min-width:0;
    }

    .favTitle{
      margin:0;
      font-size:0.92rem;
      font-weight:600;
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
    }

    .favSub{
      margin:4px 0 0;
      font-size:0.82rem;
      color: var(--text-dim);
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
    }

    /* Listening To */
    .listenGrid{
      display:flex;
      flex-direction:column;
      gap:12px;
    }

    .trackCard{
      display:grid;
      grid-template-columns: 76px 1fr;
      gap:14px;
      align-items:center;

      padding:14px;
      border-radius:16px;
      background: rgba(255,255,255,0.10);
      border:1px solid rgba(255,255,255,0.12);
    }

    .albumCover{
      width:76px;
      height:76px;
      border-radius:14px;
      object-fit: cover;
      border:1px solid rgba(255,255,255,0.14);
      display:block;
      background: rgba(0,0,0,0.15);
    }

    .trackMeta{ min-width:0; }

    .trackName{
      margin:0;
      font-size: 1.03rem;
      font-weight: 600;
      line-height: 1.2;
    }

    .trackSub{
      margin:4px 0 10px;
      color: var(--text-dim);
      font-size: 0.95rem;
      line-height: 1.2;
    }

    .playerRow{
      display:flex;
      align-items:center;
      gap:10px;
    }

    .playBtn{
      width:34px;
      height:34px;
      border-radius:12px;
      border:1px solid rgba(255,255,255,0.18);
      background: rgba(255,255,255,0.10);
      color:#fff;
      display:flex;
      align-items:center;
      justify-content:center;
      cursor:pointer;
      flex:0 0 auto;
      transition: transform .12s ease, background .18s ease;
      user-select:none;
      -webkit-tap-highlight-color: transparent;
    }
    .playBtn:hover{ transform: translateY(-1px); background: rgba(255,255,255,0.16); }
    .playIcon{ font-size: 0.95rem; opacity: 0.92; }

    /* Range input: consistent & reliably clickable */
    .scrub{
      width:100%;
      accent-color: rgba(255,255,255,0.75);
      position: relative;
      z-index: 5;
      pointer-events: auto;
      cursor: pointer;
      touch-action: none;
      -webkit-appearance: none;
      appearance: none;
      height: 18px;
      background: transparent;
      padding: 0; margin: 0;
    }

    .scrub::-webkit-slider-runnable-track{
      height: 4px;
      border-radius: 999px;
      background: rgba(255,255,255,0.22);
    }
    .scrub::-webkit-slider-thumb{
      -webkit-appearance: none;
      appearance: none;
      width: 12px;
      height: 12px;
      margin-top: -4px;
      border-radius: 50%;
      background: rgba(255,255,255,0.85);
      border: 1px solid rgba(0,0,0,0.25);
    }

    .scrub::-moz-range-track{
      height: 4px;
      border-radius: 999px;
      background: rgba(255,255,255,0.22);
    }
    .scrub::-moz-range-thumb{
      width: 12px;
      height: 12px;
      border-radius: 50%;
      background: rgba(255,255,255,0.85);
      border: 1px solid rgba(0,0,0,0.25);
    }

    .timeRow{
      display:flex;
      justify-content:space-between;
      margin-top:6px;
      color: var(--text-dimmer);
      font-size: 0.82rem;
      letter-spacing: 0.02em;
    }

    footer{
      margin-top:18px;
      font-size:0.75rem;
      opacity:0.6;
      text-align:center;
    }

    @media (max-width: 480px){
      body{ padding: 28px 12px; }
      main{ padding: 22px; }

      .displayName{ font-size: 2.0rem; }
      .pfp{ width:68px; height:68px; border-radius:16px; }

      .mediaThumb{ width:86px; height:124px; }
      .trackCard{ grid-template-columns: 72px 1fr; }
      .albumCover{ width:72px; height:72px; }
    }
  </style>
</head>

<body>
  <main>
    <!-- HEADER -->
    <div class="header">
      <img class="pfp" src="assets/profile.webp" alt="Profile photo">
      <div>
        <div class="nameRow">
          <h1 class="displayName">Roberto ðŸ’¿</h1>
        </div>
      </div>
    </div>

    <!-- CHIPS -->
    <div class="chips" aria-label="Quick info">
      <div class="chip">he/him</div>
      <div class="chip">20</div>
      <div class="chip">Baltimore</div>
      <div class="chip">EN / ES</div>
    </div>

    <!-- LINKS -->
    <section class="links" aria-label="Social links">
      <a class="button" href="https://twitter.com/egemago" target="_blank" rel="noopener">
        <span class="leftWrap">
          <img class="socialLogo" src="assets/twitter-logo.png" alt="">
          <span class="linkText">Twitter</span>
        </span>
        <span class="arrow">â†—</span>
      </a>

      <a class="button" href="https://letterboxd.com/stoneyend/" target="_blank" rel="noopener">
        <span class="leftWrap">
          <img class="socialLogo" src="assets/letterboxd-logo.png" alt="">
          <span class="linkText">Letterboxd</span>
        </span>
        <span class="arrow">â†—</span>
      </a>

      <a class="button" href="https://rateyourmusic.com/~egemago" target="_blank" rel="noopener">
        <span class="leftWrap">
          <img class="socialLogo" src="assets/rym-logo.png" alt="">
          <span class="linkText">RYM</span>
        </span>
        <span class="arrow">â†—</span>
      </a>

      <a class="button" href="https://www.last.fm/user/egemago" target="_blank" rel="noopener">
        <span class="leftWrap">
          <img class="socialLogo" src="assets/lastfm-logo.png" alt="">
          <span class="linkText">last.fm</span>
        </span>
        <span class="arrow">â†—</span>
      </a>

      <a class="button" href="https://music.apple.com/profile/egemago" target="_blank" rel="noopener">
        <span class="leftWrap">
          <img class="socialLogo" src="assets/applemusic-logo.png" alt="">
          <span class="linkText">Apple Music</span>
        </span>
        <span class="arrow">â†—</span>
      </a>
    </section>

    <!-- EXTENDED BIO -->
    <div class="sectionTitle">Extended Bio</div>
    <div class="bioBox">
      My name's Roberto. I mainly discuss music, but I love books, film, anime, manga, the gym, and Tottenham Hotspur. I was born in El Salvador, but have lived in Baltimore for most of my life. I am currently an Accounting and Finance major and a studying socialist.
    </div>

    <!-- I AM -->
    <div class="sectionTitle">I Am</div>
    <div class="mediaGrid" aria-label="Currently reading and watching">
      <div class="mediaCard">
        <img class="mediaThumb" src="assets/wuthering-heights.jpeg" alt="Cover of Wuthering Heights by Emily BrontÃ«">
        <div class="mediaText">
          <p class="mediaTitle">Currently Reading</p>
          <p class="mediaSub">Wuthering Heights by Emily BrontÃ«</p>
        </div>
      </div>

      <div class="mediaCard">
        <img class="mediaThumb" src="assets/twin-peaks.jpeg" alt="Twin Peaks">
        <div class="mediaText">
          <p class="mediaTitle">Currently Rewatching</p>
          <p class="mediaSub">Twin Peaks</p>
        </div>
      </div>
    </div>

    <!-- FAVORITE ALBUMS -->
    <div class="sectionTitle">Favorite Albums</div>
    <div class="favGrid" aria-label="Favorite albums">
      <a class="favCard" href="https://rateyourmusic.com/release/album/geordie-greep/the-new-sound/" target="_blank" rel="noopener">
        <img class="favCover" src="assets/new-sound.png" alt="The New Sound album cover" loading="lazy">
        <div class="favMeta">
          <p class="favTitle">The New Sound</p>
          <p class="favSub">Geordie Greep (2024)</p>
        </div>
      </a>

      <a class="favCard" href="https://rateyourmusic.com/release/album/xtc/skylarking/" target="_blank" rel="noopener">
        <img class="favCover" src="assets/skylarking.png" alt="Skylarking album cover" loading="lazy">
        <div class="favMeta">
          <p class="favTitle">Skylarking</p>
          <p class="favSub">XTC (1986)</p>
        </div>
      </a>

      <a class="favCard" href="https://rateyourmusic.com/release/album/underscores/wallsocket/" target="_blank" rel="noopener">
        <img class="favCover" src="assets/wallsocket-logo.webp" alt="Wallsocket album cover" loading="lazy">
        <div class="favMeta">
          <p class="favTitle">Wallsocket</p>
          <p class="favSub">underscores (2023)</p>
        </div>
      </a>

      <a class="favCard" href="https://rateyourmusic.com/release/album/can/ege-bamyasi/" target="_blank" rel="noopener">
        <img class="favCover" src="assets/ege-bamyasi.jpg" alt="Ege Bamyasi album cover" loading="lazy">
        <div class="favMeta">
          <p class="favTitle">Ege Bamyasi</p>
          <p class="favSub">Can (1972)</p>
        </div>
      </a>

      <a class="favCard" href="https://rateyourmusic.com/release/album/invisible/el-jardin-de-los-presentes/" target="_blank" rel="noopener">
        <img class="favCover" src="assets/jardin-presentes.png" alt="El jardÃ­n de los presentes album cover" loading="lazy">
        <div class="favMeta">
          <p class="favTitle">El jardÃ­n de los presentes</p>
          <p class="favSub">Invisible (1976)</p>
        </div>
      </a>
    </div>

    <!-- FAVORITE ANIMANGA -->
    <div class="sectionTitle">Favorite Animanga</div>
    <div class="favGrid" aria-label="Favorite anime and manga">
      <a class="favCard" href="https://myanimelist.net/anime/30/Neon_Genesis_Evangelion" target="_blank" rel="noopener">
        <img class="posterCover" src="assets/eva.jpg" alt="Neon Genesis Evangelion poster" loading="lazy">
        <div class="favMeta">
          <p class="favTitle">Neon Genesis Evangelion</p>
          <p class="favSub">Anime</p>
        </div>
      </a>

      <a class="favCard" href="https://myanimelist.net/anime/227/FLCL" target="_blank" rel="noopener">
        <img class="posterCover" src="assets/flcl.jpg" alt="FLCL poster" loading="lazy">
        <div class="favMeta">
          <p class="favTitle">FLCL</p>
          <p class="favSub">Anime</p>
        </div>
      </a>

      <a class="favCard" href="https://myanimelist.net/manga/1/Monster" target="_blank" rel="noopener">
        <img class="posterCover" src="assets/monster.jpg" alt="Monster manga cover" loading="lazy">
        <div class="favMeta">
          <p class="favTitle">Monster</p>
          <p class="favSub">Manga</p>
        </div>
      </a>

      <a class="favCard" href="https://myanimelist.net/manga/21/Chainsaw_Man" target="_blank" rel="noopener">
        <img class="posterCover" src="assets/chainsaw-man.jpg" alt="Chainsaw Man manga cover" loading="lazy">
        <div class="favMeta">
          <p class="favTitle">Chainsaw Man</p>
          <p class="favSub">Manga</p>
        </div>
      </a>

      <a class="favCard" href="https://myanimelist.net/manga/1517/JoJo_no_Kimyou_na_Bouken" target="_blank" rel="noopener">
        <img class="posterCover" src="assets/jojos.jpg" alt="JoJo's Bizarre Adventure manga cover" loading="lazy">
        <div class="favMeta">
          <p class="favTitle">JoJo's Bizarre Adventure</p>
          <p class="favSub">Manga</p>
        </div>
      </a>
    </div>

    <!-- LISTENING TO -->
    <div class="sectionTitle">Listening To</div>
    <div class="listenGrid" aria-label="Music player">
      <!-- Track 1 -->
      <div class="trackCard" data-track>
        <img class="albumCover" src="assets/englishsettlement-logo.jpg" alt="English Settlement cover">
        <div class="trackMeta">
          <p class="trackName">Jason and the Argonauts</p>
          <p class="trackSub">XTC â€¢ <em>English Settlement</em></p>

          <div class="playerRow">
            <button class="playBtn" type="button" aria-label="Play/Pause">
              <span class="playIcon">â–¶</span>
            </button>
            <input class="scrub" type="range" min="0" max="100" value="0" step="0.1" aria-label="Seek">
          </div>

          <div class="timeRow">
            <span class="curTime">0:00</span>
            <span class="durTime">0:00</span>
          </div>

          <audio preload="metadata" src="assets/audio/jason-and-the-argonauts.mp3"></audio>
        </div>
      </div>

      <!-- Track 2 -->
      <div class="trackCard" data-track>
        <img class="albumCover" src="assets/bizarreride-logo.jpg" alt="Bizarre Ride II the Pharcyde cover">
        <div class="trackMeta">
          <p class="trackName">Otha Fish</p>
          <p class="trackSub">The Pharcyde â€¢ <em>Bizarre Ride II the Pharcyde</em></p>

          <div class="playerRow">
            <button class="playBtn" type="button" aria-label="Play/Pause">
              <span class="playIcon">â–¶</span>
            </button>
            <input class="scrub" type="range" min="0" max="100" value="0" step="0.1" aria-label="Seek">
          </div>

          <div class="timeRow">
            <span class="curTime">0:00</span>
            <span class="durTime">0:00</span>
          </div>

          <audio preload="metadata" src="assets/audio/otha-fish.mp3"></audio>
        </div>
      </div>

      <!-- Track 3 -->
      <div class="trackCard" data-track>
        <img class="albumCover" src="assets/wallsocket-logo.webp" alt="Wallsocket cover">
        <div class="trackMeta">
          <p class="trackName">Locals (Girls like us)</p>
          <p class="trackSub">underscores â€¢ <em>Wallsocket</em></p>

          <div class="playerRow">
            <button class="playBtn" type="button" aria-label="Play/Pause">
              <span class="playIcon">â–¶</span>
            </button>
            <input class="scrub" type="range" min="0" max="100" value="0" step="0.1" aria-label="Seek">
          </div>

          <div class="timeRow">
            <span class="curTime">0:00</span>
            <span class="durTime">0:00</span>
          </div>

          <audio preload="metadata" src="assets/audio/locals-girls-like-us.mp3"></audio>
        </div>
      </div>
    </div>

    <footer>âœ¦ built with Cloudflare Pages âœ¦</footer>
  </main>

  <script>
    // One track plays at a time + robust desktop/mobile seek.
    const tracks = Array.from(document.querySelectorAll('[data-track]'));

    const fmt = (t) => {
      if (!isFinite(t) || t < 0) return "0:00";
      const m = Math.floor(t / 60);
      const s = Math.floor(t % 60);
      return `${m}:${String(s).padStart(2, "0")}`;
    };

    function setButton(card, playing){
      const icon = card.querySelector('.playIcon');
      icon.textContent = playing ? "âšâš" : "â–¶";
    }

    function stopOthers(exceptAudio){
      tracks.forEach(card => {
        const a = card.querySelector('audio');
        if (a !== exceptAudio) {
          a.pause();
          a.currentTime = 0;

          const scrub = card.querySelector('.scrub');
          const cur = card.querySelector('.curTime');

          scrub.value = 0;
          cur.textContent = "0:00";
          setButton(card, false);
        }
      });
    }

    function ensureMetadata(audio, durEl) {
      return new Promise((resolve) => {
        if (audio.readyState >= 1 && isFinite(audio.duration) && audio.duration > 0) {
          if (durEl) durEl.textContent = fmt(audio.duration);
          resolve();
          return;
        }

        const onMeta = () => {
          if (durEl) durEl.textContent = fmt(audio.duration);
          resolve();
        };

        audio.addEventListener('loadedmetadata', onMeta, { once: true });

        try { audio.load(); } catch (_) {}
      });
    }

    tracks.forEach(card => {
      const audio = card.querySelector('audio');
      const playBtn = card.querySelector('.playBtn');
      const scrub = card.querySelector('.scrub');
      const cur = card.querySelector('.curTime');
      const dur = card.querySelector('.durTime');

      let isSeeking = false;

      ensureMetadata(audio, dur);

      audio.addEventListener('timeupdate', () => {
        if (!isFinite(audio.duration) || audio.duration <= 0) return;

        if (!isSeeking) {
          const pct = (audio.currentTime / audio.duration) * 100;
          scrub.value = String(pct);
        }
        cur.textContent = fmt(audio.currentTime);
      });

      audio.addEventListener('ended', () => {
        setButton(card, false);
        scrub.value = 0;
        cur.textContent = "0:00";
      });

      playBtn.addEventListener('click', async () => {
        if (audio.paused) {
          stopOthers(audio);
          await ensureMetadata(audio, dur);

          try {
            await audio.play();
            setButton(card, true);
          } catch (e) {
            console.warn("Audio play failed:", e);
            setButton(card, false);
          }
        } else {
          audio.pause();
          setButton(card, false);
        }
      });

      function seekFromPointer(e){
        const rect = scrub.getBoundingClientRect();
        const clientX = (e.touches && e.touches[0]) ? e.touches[0].clientX : e.clientX;
        const x = Math.min(Math.max(clientX - rect.left, 0), rect.width);
        const pct = rect.width ? (x / rect.width) : 0;

        audio.currentTime = pct * audio.duration;
        scrub.value = String(pct * 100);
        cur.textContent = fmt(audio.currentTime);
      }

      scrub.addEventListener('input', async () => {
        await ensureMetadata(audio, dur);
        if (!isFinite(audio.duration) || audio.duration <= 0) return;

        const pct = Number(scrub.value) / 100;
        audio.currentTime = pct * audio.duration;
        cur.textContent = fmt(audio.currentTime);
      });

      scrub.addEventListener('pointerdown', async (e) => {
        isSeeking = true;
        scrub.setPointerCapture?.(e.pointerId);

        await ensureMetadata(audio, dur);
        if (!isFinite(audio.duration) || audio.duration <= 0) return;

        seekFromPointer(e);
      });

      scrub.addEventListener('pointermove', (e) => {
        if (!isSeeking) return;
        if (!isFinite(audio.duration) || audio.duration <= 0) return;
        seekFromPointer(e);
      });

      scrub.addEventListener('pointerup', (e) => {
        if (!isSeeking) return;
        if (isFinite(audio.duration) && audio.duration > 0) {
          seekFromPointer(e);
        }
        isSeeking = false;
        scrub.releasePointerCapture?.(e.pointerId);
      });

      scrub.addEventListener('pointercancel', () => {
        isSeeking = false;
      });

      scrub.addEventListener('click', async (e) => {
        await ensureMetadata(audio, dur);
        if (!isFinite(audio.duration) || audio.duration <= 0) return;
        seekFromPointer(e);
      });
    });
  </script>
</body>
</html>
